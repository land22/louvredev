{% extends "LWLouvreBundle::layout.html.twig" %}
{%block into %}
{% for message in app.flashes('notice') %}
     <div class="alert alert-danger" style="margin-top:1.5%;"><strong>
        {{ message }}
    </strong></div>
{% endfor %}
 <div class="alert alert-info information">
  Nous vous précisons pour des raisons de gestion qu’il n’est pas possible de réserver pour <strong>les jours passés (!) , les dimanches, les jours fériés et les jours où plus de 1000 billets ont été vendus en tout pour ne pas dépasser la capacité du musée.</strong>. Merci pour votre bonne comprehension !!! 
</div>
{%endblock%}
{%block container%}    
	 
   
<div class="form">
	
			{{ form_start(form, {'attr': {'class': 'form-inline'}}) }} 
			{# Les erreurs générales du formulaire. #} 
			{{ form_errors(form) }}
	
			<div id="form_louvre">
				<div class="form-group">
			    	<label for="nbBillets">Choisissez un mombre de billets</label>
			    	<input type="number" class="form-control nbr_billet" id="nbBillets" aria-describedby="Saisir le nombre de billets" min="1" placeholder="Saisir le nombre de billets" name ="nbr_billet" required>			    	
			  	</div>
				<div class="form-group">
					{{ form_label(form.visiteDate, "Date de votre visite", {'label_attr': {'class': 'datevisitlabel'}}) }} 
					{{ form_errors(form.visiteDate) }} 
					{{ form_widget(form.visiteDate) }}
				</div>
				<div class="form-group">
					{{ form_label(form.typeOrder, "Type de journée", {'label_attr': {'class': 'typelabel'}}) }}
					{{ form_errors(form.typeOrder) }}
					{{ form_widget(form.typeOrder, {'attr':	{'class': 'type_journee form-control','id':'type_journee'}}) }}
				</div>
				<div class="form-group" style="display: none;">
					{{ form_label(form.email, "Votre adresse email", {'label_attr': {'class': 'emaillabel'}}) }} 
					{{ form_errors(form.email) }}
					{{ form_widget(form.email, {'attr':{'class': 'form-control'}}) }}
				</div>
                                <br />
                                <br />
				<button id="add_billet" class="btn btn-default">Enregistrer les billets</button>
				<div id="billets" style = "display:none;">
					
				</div>
				<div class="col-sm-12" style = "display:none;" id = "bloc_save">
					{# Pour le bouton, pas de label ni d'erreur, on affiche juste le widget #}
					{{ form_widget(form.save, {'attr': {'class': 'step1 btn btn-primary'}}) }} 
		       </div>
			</div>
			
			
		
		</div>
		<br>
				
		
		<br>
		<br> {# Génération automatique des champs pas encore écrits. Dans cet exemple, ce serait le champ CSRF (géré automatiquement par Symfony !) et tous les champs cachés (type « hidden »). #} 
		{{ form_rest(form) }}
		
		{# Fermeture de la balise <form>du formulaire HTML #}		
		{{ form_end(form) }}
</div>

<div class="alert tarification">
 <h3>Tarifications</h3>
   <ul class="list-group">
  <li class="list-group-item">Un tarif « normal » à partir de 12 ans<span class="badge">16€</span></li>
  <li class="list-group-item">Un tarif « enfant » à partir de 4 ans et jusqu’à 12 ans(l’entrée est gratuite pour les enfants de moins de 4 ans) <span class="badge">8€</span></li>
  <li class="list-group-item">Un tarif « senior » à partir de 60 ans <span class="badge">12€</span></li>
  <li class="list-group-item">Un tarif « réduit » accordé dans certaines conditions (étudiant, employé du musée, d’un service du Ministère de la Culture, militaire…) <span class="badge">10€</span></li>
</ul> 
</div>
{%endblock%}
{%block javascript%}
    {{ parent() }}
    <script src="{{ asset('assets/js/datePicker.js')}}"></script>
    <script>
        var date = new Date();
        $('.datepicker').datepicker({
          format: "dd/mm/yyyy",
          default: 'dd/mm/yyyy',
          startDate: '-3d',
          startDate: date,
          language: "fr",
          datesDisabled: ['11/01/'+date.getFullYear(), '12/25/'+date.getFullYear(),'05/01/'+date.getFullYear()],
          daysOfWeekDisabled: "2,0"
        });
    </script>

    <script>
     	$(function() {
	     	  //varition de la l'option journée et demi journée
	     	  var date_jour = new Date();
              if (date_jour.getHours() > 13) {
	     	 $('.form .type_journee').html('<option value="Demi-journée">Demi-journée</option>');
	     	 }
            //Action exercution lorsqu'on clique sur le lien ajouter un billet
	        $("#add_billet").on("click", function(){
		      	if($("#nbBillets").val() >= 1 && $("#lw_louvrebundle_orders_visiteDate").val() != "" && $("#lw_louvrebundle_orders_typeOrder").val() != ""  ){
	                //Afficher le contenu du formulaire des billets
	                var ticketsContent = $("#lw_louvrebundle_orders_tickets").attr("data-prototype");
	                $("#billets").html("");
	                for (var i = 0; i<$("#nbBillets").val(); i++) 
	                {
	                    var container = ticketsContent.replace(/__name__label__/g, 'Billet n°' + (i+1)).replace(/__name__/g,        i)
	                    $("#billets").append(container);
	                    $("#billets").show();
	                }
	                $("#bloc_save").show();
                }

	        });
        });

    </script>
    {%endblock%}